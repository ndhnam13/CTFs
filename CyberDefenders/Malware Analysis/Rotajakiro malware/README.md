# Mô tả

A company’s Linux server was flagged for unusual internet traffic. The file responsible appeared to be a legitimate program but acted strangely and kept running even after being stopped. Your task is to analyze the malware sample to understand what it does, how it hides, and how it stays active on the system.

Bài cho ta file malware - là một file ELF

# Phân tích

**What is the SHA256 hash of the file?**

`d1cdeea8a081397632c0522476da2122f93c71cb14a36ad4e8d4351b3d65fd6d`

**What is the entry point address of the binary if the image base is `0x400000`?**

0x401e30

**How many sections in the file contain executable code?**

Đối với file ELF có thể dùng `readelf -S` option `-S` là để liệt kê tất cả các section header, muốn tìm section nào chứa executable code thì có thể tìm flag `X: Executable`

```bash
$ readelf -S RotaJakiro.malware | grep X
       000000000000001a  0000000000000000  AX       0     0     4
       0000000000000570  0000000000000010  AX       0     0     16
       0000000000016962  0000000000000000  AX       0     0     16
       0000000000000009  0000000000000000  AX       0     0     4
  W (write), A (alloc), X (execute), M (merge), S (strings), I (info),
```

`4`

**Which system call/function does the binary use to obtain its absolute path?**

`readlink`

**As a persistence mechanism, the malware copies itself to two locations when executed by a regular, non root, user. What are the names of the new dropped binaries?**

Sử dụng `strace` rồi vào thư mục log check sẽ thấy 2 file được drop

`gvfsd-helper,session-dbus`

**Which file does the malware modify to ensure it runs every time a terminal session is started?**

`.bashrc`

**Which technique does the malware use to store strings before decrypting them?**

Khi đưa vào IDA có thể thấy trước khi thực hiện drop các file `gvfsd-helper,session-dbus` thì chúng không được hardcode trong string của malware mà được nạp động vào khi chương trình chạy -> Nạp chuỗi bị mã hoá -> Thực hiện giải mã

`Stack Strings`

**What is the address of the function responsible for decrypting strings if the image base is `0x400000`? This function is typically invoked right after each encrypted string is built on the stack.**

`0x402b80`

**Which system call/function is used by the malware to delete the original, first executed, file?**

`unlink`

**The malware decodes four embedded strings representing command-and-control (C2) domains. What are these domains?**

Check phần contacted domains trên virustotal

`0b3l1sk.me,cdn.mirror-codes.net,status.sublineover.net,blog.eduelects.com`